## AWS S3

https://inpa.tistory.com/entry/AWS-%F0%9F%93%9A-S3-%EB%B2%84%ED%82%B7-%EC%83%9D%EC%84%B1-%EC%82%AC%EC%9A%A9%EB%B2%95-%EC%8B%A4%EC%A0%84-%EA%B5%AC%EC%B6%95



### S3 버킷 / 객체 개념

S3에는 Bucket과 Object라는 단위가 있다. 

- 객체(Object)는 데이터와 메타데이터를 구성하고 있는 저장 단위이며
- 버킷(Bucket)은 이러한 객체를 저장하고 관리하는 역할을 한다.



버킷은 그냥 디렉토리/폴더 개념으로 키는 파일명으로 이해해도 된다.

만약 User라는 이름의 버킷에 profile.png 객체 파일을 저장하면 http://User.s3.amazonaws.com/profile.png라는 URL이 생성되게 된다.

S3을 구성할때, **버킷(Bucket)**이라는 컨테이너를 놓을 **리전을 선택**하고, 해당 컨테이너 내부에 **객체(Object)**라는 형태로 데이터를 저장하는 형태로 스토리지를 구축한다.

한 계정 당 Bucket은 최대 100개까지 사용이 가능하고, 버킷 단위로 접근 제한을 설정할 수도 있다.

단, Bucket의 소유권은 이전할 수 없기 때문에 주의해야 한다.

 

**S3에 저장되는 데이터는 모두 객체**라고 부른다.

객체는 하나 당 1Byte에서 최대 5TB까지 저장이 가능하며 저장할 수 있는 객체의 수는 제한이 없다.

각 객체는 데이터와 메타데이터를 지니는데 S3 버킷에 올리는 객체가 바로 데이터이고 **최종 수정일, 파일 타입 등의 데이터를 메타데이터**라고 한다. (메타데이터는 네임-벨류 쌍으로 이우러져 있다.)

객체는 **키**를 통해서 버킷에서 유일한 것으로 식별될 수 있으며, 버킷에 존재하는 모든 객체는 단 하나의 키를 지닌다.

따라서 **S3 내에서 버킷, 키, 버전 ID를 통해 특정 객체를 파악**할 수 있다.



#### **S3 리전(Region) 구성**

- S3가 생성한 버킷을 저장할 위치를 지정한다.
- 리전 간 객체 공유는 불가능
- 버킷 위치(리전)을 어디에 지정하냐에 따라 지연 시간, 비용 등이 결정되게 된다.

 

#### **S3 버킷(bucket) 구성**

- Amazon S3에서 생성되는 최상위의 디렉토리이며, Amazon S3에 저장된 객체의 컨테이너 이다.
- S3상의 모든 객체는 버킷에 포함된다.
- 버킷의 이름은 S3에서 유일해야 한다.
  게임 아이디같이 중복될수가 없다. 즉, 전세계에 어디에도 중복된 이름이 존재 할 수 가 없다.
- 한 계정 당 최대 100개의 버킷 사용 가능.
- 버킷 주소는 https://bucketname.s3.Region.amazonaws.com 형태로 이루어진다.
- 버킷을 생성하면 default로 private상태이다.
- 버킷 소유권은 이전할 수 없다.
- 버킷 안에 다른 버킷을 둘 수 없다.



#### **S3 객체(Object) 특징**

- 객체 하나의 크기는 1Byte ~ 5TB
- 저장 가능한 객체 갯수 무제한
- 객체마다 각각의 접근 권한 설정 가능
- 객체 metadata는 객체가 업로드 된 후에는 수정될 수 없고, 복사해서 수정해야 한다.
- 객체의 metadata는 response header에 반환된다.
- 객체를 그룹화하는 디렉터리를 생성할 수 있다. 따라서 폴더, 파일 처럼 디렉터리를 계층화해서 객체를 저장할 수도 있다.



### 버킷 생성시

**이 버킷의 퍼블릭 액세스를 차단한다는 것**은 외부에서도 파일을 읽게 하지 못한다는 의미다.

퍼블릭 액세스를 경우에 따라 차단하고 싶다면, "모든 퍼블릭 액세스 차단"은 비활성화하고 세부적인 옵션을 선택하면 된다.

- **새 ACL(액세스 제어 목록)을 통해 부여된 버킷 및 객체에 대한 퍼블릭 액세스 차단**
  → 지정된 ACL이 퍼블릭이거나, 요청에 퍼블릭 ACL이 포함되어 있으면 PUT 요청을 거절한다.
- **임의의 ACL(액세스 제어 목록)을 통해 부여된 버킷 및 객체에 대한 퍼블릭 액세스 차단**
  → 버킷의 모든 퍼블릭 ACL과 그 안에 포함된 모든 Object를 무시하고, 퍼블릭 ACL를 포함하는 PUT 요청은 허용한다.
- **새 퍼블릭 버킷 또는 액세스 지점 정책을 통해 부여된 버킷 및 객체에 대한 퍼블릭 액세스 차단**
  → 지정된 버킷 정책이 퍼블릭이면 PUT 요청을 거절한다. 이 설정을 체크하면 버킷 및 객체에 대한 퍼블릭 액세스를 차단하고 사용자가 버킷 정책을 관리할 수 있으며, 이 설정 활성화는 기존 버킷 정책에 영향을 주지 않는다.
- **임의의 퍼블릭 버킷 또는 액세스 지점 정책을 통해 부여된 버킷 및 객체에 대한 퍼블릭 액세스 차단**
  → 퍼블릭 정책이 있는 버킷에 대한 액세스가 권한이 있는 사용자와 AWS 서비스로만 제한되며, 이 설정 활성화는 기존 버킷 정책에 영향을 주지 않는다.